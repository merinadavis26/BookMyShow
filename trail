import { Component, OnInit } from '@angular/core';
import { NgbModal } from '@ng-bootstrap/ng-bootstrap';
import { MovieService } from '../services/movie.service';

@Component({
  selector: 'app-movie-management',
  templateUrl: './movie-management.component.html',
  styleUrls: ['./movie-management.component.css']
})
export class MovieManagementComponent implements OnInit {
  movies: any[] = [];
  newMovie: any = {};
  editMovieData: any = {};

  constructor(private modalService: NgbModal, private movieService: MovieService) { }

  ngOnInit(): void {
    this.loadMovies();
  }

  loadMovies(): void {
    this.movies = this.movieService.getMovies();
  }

  editMovie(movie: any): void {
    this.editMovieData = { ...movie }; // Clone the movie object
    // Open edit modal if needed
  }

  saveEditedMovie(): void {
    this.movieService.editMovie(this.editMovieData);
    this.editMovieData = {}; // Clear edit data
    // Close modal if needed
  }

  confirmDelete(movie: any): void {
    if (confirm(`Are you sure you want to delete ${movie.title}?`)) {
      this.movieService.deleteMovie(movie.id);
      this.loadMovies(); // Reload movies after delete
    }
  }

  onSubmit(): void {
    this.movieService.addMovie(this.newMovie);
    this.newMovie = {}; // Clear new movie data
    this.modalService.dismissAll(); // Close modal after adding
    this.loadMovies(); // Reload movies after add
  }
}
